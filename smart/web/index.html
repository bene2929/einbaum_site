<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1">
<script src="jquery-1.11.3.min.js"></script>
<script type="text/javascript">
	var led0 = false;
	var led1 = false;
	var led2 = false;
	var temp0 = -1;
	var isWriting = false;
	function changeOut(i) {
	    isWriting = true;
		switch (i) {
		case 0:

			led0 = !led0;

			break;
		case 1:

			led1 = !led1;

			break;

		default:
			break;
		}
		loadValues();
		write();
	}
	function loadValues() {
		if (led1) {
			document.getElementById("led1").innerHTML = "Ein";
		} else {
			document.getElementById("led1").innerHTML = "Aus";
		}
		if (led0) {
			document.getElementById("led0").innerHTML = "Ein";
		} else {
			document.getElementById("led0").innerHTML = "Aus";
		}
		document.getElementById("temp0").innerHTML = temp0;
	}

	function read() {
	    if (!isWriting) {
	        $.get("data.txt", function (data, status) {
	            //alert("Data: " + data + "\nStatus: " + status);
	            var arr = data.split("\n");
	            for (i = 0; i < arr.length; i++) {
	                var parts = arr[i].split(";");

	                if (parts[0] == "led0") {
	                    if (parts[1].charAt(0) == '1') {
	                        led0 = true;

	                    } else {
	                        led0 = false;

	                    }

	                } else if (parts[0] == "led1") {
	                    if (parts[1].charAt(0) == '1') {

	                        led1 = true;
	                    } else {
	                        led1 = false;
	                    }

	                } else if (parts[0] == "temp0") {
	                    temp0 = (parseInt(parts[1]));

	                }

	            }
	            loadValues();

	        });
	    }

	}
	function write() {
	    var text = "led0;";
	    if (led0) {
	        text=text.concat("1");
	    } else {
	        text = text.concat("0");
	    }
	    text = text.concat("\nled1;")
	    if (led1) {
	        text = text.concat("1");
	    } else {
	        text = text.concat("0");
	    }
	    text = text.concat("\ntemp0;" + temp0);

	    $.post("DataHandler.php", { suggest: text }, function (result) {
	        document.getElementById("debug").innerHTML = "Sent:"+result;
	        isWriting = false;
	    });
	}
	function refresh() {
		location.reload(true);
	}
	window.setInterval(read, 1000);
	window.setInterval(refresh, 10000);
</script>


<title>Smart Home</title>
</head>
<body onload="read()">
	<h1>This is only a test!</h1>
	<div>Debug:</div>
	<div id="debug">no warnings</div>
	<ul>
		<li>
			<div>
				LED 0:
				<div id="led0">-</div>
			</div>
			<button id="b0" onclick="changeOut(0)">Change Value</button> <!-- <textarea
            rows="1" cols="1" id="text0"></textarea> -->
		</li>
		<li>
			<div>
				LED 1:
				<div id="led1">-</div>
			</div>
			<button id="b1" onclick="changeOut(1)">Change Value</button>
		</li>
		<li>
			<div>
				Temperatur (°C):
				<div id="temp0" />
			</div>

		</li>
	</ul>

</body>
</html>